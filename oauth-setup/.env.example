# OAuth Server Configuration

# Server Port
PORT=3000

# Environment (development, staging, production)
NODE_ENV=development

# JWT Secret Key (CHANGE THIS IN PRODUCTION!)
# Generate with: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
JWT_SECRET=your-secret-key-change-this-in-production

# JWT Expiration Times
JWT_ACCESS_TOKEN_EXPIRY=15m
JWT_REFRESH_TOKEN_EXPIRY=7d

# Allowed CORS Origins (comma-separated)
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8080

# TikTok OAuth Provider Configuration
# Get these from: https://developers.tiktok.com/
# For GitHub Actions CI, add these as repository secrets:
# TIKTOK_CLIENT_ID, TIKTOK_CLIENT_SECRET, TIKTOK_REDIRECT_URI, ALLOWED_REDIRECT_URIS
TIKTOK_CLIENT_ID=your-tiktok-client-id
TIKTOK_CLIENT_SECRET=your-tiktok-client-secret
TIKTOK_REDIRECT_URI=http://localhost:3000/auth/tiktok/callback

# Allowed Redirect URIs (comma-separated)
# Include all valid redirect URIs for your application
ALLOWED_REDIRECT_URIS=http://localhost:3000/auth/tiktok/callback,http://localhost:8080/auth/tiktok/callback

# OAuth Client Configuration (Generic)
# CLIENT_ID=your-client-id
# CLIENT_SECRET=your-client-secret

# Database Configuration (if using persistent storage)
# DB_HOST=localhost
# DB_PORT=5432
# DB_NAME=oauth_db
# DB_USER=oauth_user
# DB_PASSWORD=your-db-password

# Redis Configuration (for token storage in production)
# REDIS_HOST=localhost
# REDIS_PORT=6379
# REDIS_PASSWORD=your-redis-password

# Rate Limiting
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# Security Settings
# HTTPS_ONLY=true
# COOKIE_SECURE=true
# COOKIE_HTTP_ONLY=true
# COOKIE_SAME_SITE=strict

# Session Configuration
SESSION_SECRET=your-session-secret-change-this

# OAuth Endpoints
# AUTHORIZATION_ENDPOINT=/oauth/authorize
# TOKEN_ENDPOINT=/oauth/token
# REVOCATION_ENDPOINT=/oauth/revoke

# Logging
LOG_LEVEL=info
# LOG_FILE=logs/oauth-server.log

# Token Cleanup (milliseconds)
TOKEN_CLEANUP_INTERVAL=86400000
TOKEN_MAX_AGE=604800000

# PKCE Configuration
PKCE_REQUIRED=true
PKCE_CHALLENGE_METHOD=S256

# Refresh Token Rotation
REFRESH_TOKEN_ROTATION_ENABLED=true
REFRESH_TOKEN_REUSE_DETECTION=true
