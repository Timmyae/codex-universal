# ============================================
# Server Configuration
# ============================================
NODE_ENV=development
PORT=3000
BASE_URL=http://localhost:3000

# ============================================
# GitHub OAuth Configuration (REQUIRED)
# ============================================
# Get these from: https://github.com/settings/developers
GITHUB_CLIENT_ID=your_github_client_id_here
GITHUB_CLIENT_SECRET=your_github_client_secret_here
GITHUB_CALLBACK_URL=http://localhost:3000/auth/github/callback

# ============================================
# CRITICAL SECURITY: Redirect URI Whitelist
# ============================================
# IMPORTANT: Use exact match only, no wildcards
# Comma-separated list of allowed redirect URIs
# Example: http://localhost:3000/auth/callback,http://localhost:3000/auth/success
ALLOWED_REDIRECT_URIS=http://localhost:3000/auth/callback,http://localhost:3000/auth/success

# ============================================
# JWT Configuration (CRITICAL SECURITY)
# ============================================
# IMPORTANT: Change these in production to long random strings
# Generate with: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
JWT_SECRET=CHANGE_THIS_TO_LONG_RANDOM_STRING_IN_PRODUCTION_USE_MINIMUM_256_BITS
JWT_REFRESH_SECRET=CHANGE_THIS_TO_DIFFERENT_LONG_RANDOM_STRING_IN_PRODUCTION

# Token Expiry Settings
# Access tokens: Short-lived (15 minutes recommended)
JWT_ACCESS_TOKEN_EXPIRY=15m
# Refresh tokens: Longer-lived but rotated on use (30 days recommended)
JWT_REFRESH_TOKEN_EXPIRY=30d

# ============================================
# Security Settings
# ============================================
# Enable PKCE (Proof Key for Code Exchange) - REQUIRED for security
ENABLE_PKCE=true

# Enforce HTTPS in production - Set to true in production
ENFORCE_HTTPS=false

# Session secret for storing temporary data (code verifier)
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
SESSION_SECRET=CHANGE_THIS_IN_PRODUCTION_USE_MINIMUM_256_BITS

# CORS Configuration
# Comma-separated list of allowed origins
CORS_ORIGINS=http://localhost:3000,http://localhost:3001

# ============================================
# Optional: Redis for Token Blacklist
# ============================================
# Recommended for production to handle token revocation across multiple servers
# REDIS_URL=redis://localhost:6379
# REDIS_HOST=localhost
# REDIS_PORT=6379
# REDIS_PASSWORD=
# REDIS_DB=0

# ============================================
# Rate Limiting Configuration
# ============================================
# Window: Time window in milliseconds (15 minutes = 900000ms)
RATE_LIMIT_WINDOW_MS=900000
# Max requests per window per IP
RATE_LIMIT_MAX_REQUESTS=100

# Auth endpoint specific limits (more restrictive)
AUTH_RATE_LIMIT_WINDOW_MS=900000
AUTH_RATE_LIMIT_MAX_REQUESTS=20

# ============================================
# Logging Configuration
# ============================================
# Log level: error, warn, info, debug
LOG_LEVEL=info
# Log format: combined, common, dev, short, tiny
LOG_FORMAT=combined

# ============================================
# Security Headers (Helmet.js)
# ============================================
# Content Security Policy
CSP_DIRECTIVES="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'"

# ============================================
# Production Security Checklist
# ============================================
# Before deploying to production, ensure:
# ✓ All secrets are changed to cryptographically secure random values
# ✓ ENFORCE_HTTPS=true
# ✓ NODE_ENV=production
# ✓ Redis is configured for token blacklist
# ✓ Rate limits are appropriately configured
# ✓ CORS_ORIGINS contains only your production domains
# ✓ ALLOWED_REDIRECT_URIS contains only your production callback URLs
# ✓ All sensitive data is properly secured
# ✓ Security headers are enabled
# ✓ Monitoring and logging are configured
